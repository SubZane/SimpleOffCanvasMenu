/*! flypanels - v2.0.5 - 2017-04-20
* https://github.com/SubZane/flyPanels
* Copyright (c) 2017 Andreas Norman; Licensed MIT */
!function(a,b){"function"==typeof define&&define.amd?define([],b(a)):"object"==typeof exports?module.exports=b(a):a.flyPanels=b(a)}("undefined"!=typeof global?global:this.window||this.global,function(a){"use strict";var b,c,d,e,f={},g=!!document.querySelector&&!!a.addEventListener,h=document.documentElement.clientHeight,i=(document.querySelector(".flypanels-left").clientWidth,!0),j=(document.querySelector(".flypanels-topbar").clientHeight,{init:!1,expandHandler:"a.expand"}),k={init:!1,saveQueryCookie:!1,searchPanel:document.querySelector('.offcanvas [data-panel="search"]')},l={transitiontime:200,container:".flypanels-container",initClass:"js-flyPanels",onInit:function(){},onInitTreeMenu:function(){},onOpen:function(){},onClose:function(){},onOpenLeft:function(){},onCloseLeft:function(){},onOpenRight:function(){},onCloseRight:function(){},afterWindowResize:function(){},OnAttachEvents:function(){},onWindowResize:function(){},onEmptySearchResult:function(){},onSearchError:function(){},onSearchSuccess:function(){},onInitSearch:function(){},onDestroy:function(){}},m=function(){var a=document.createElement("div");a.className="scrollbar-measure",document.body.appendChild(a),e=a.offsetWidth-a.clientWidth,document.body.removeChild(a)},n=function(){document.querySelector(".flypanels-left").style.height=h+"px",document.querySelector(".flypanels-right").style.height=h+"px";var a=document.querySelector(".flypanels-overlay");a&&(a.style.height=h)},o=function(){(G()||H())&&document.querySelector(".flypanels-treemenu").classList.add("touch");var a=document.querySelectorAll(".flypanels-treemenu li.haschildren "+b.treeMenu.expandHandler);R(a,function(a,b){a.addEventListener("click",function(a){this.parentElement.parentElement.classList.toggle("expanded"),a.preventDefault()})}),P("onInitTreeMenu")},p=function(){var a=document.body.scrollHeight,b=document.documentElement.clientHeight,c=a>b;return c},q=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:!1},r=function(){B(),z(),x()},s=function(){document.querySelector("body").classList.remove("flypanels-open"),document.querySelector("html").classList.remove("flypanels-open"),document.querySelector(".flypanels-content").style.marginRight="",P("onCloseLeft")},t=function(){document.querySelector("body").classList.remove("flypanels-open"),document.querySelector("html").classList.remove("flypanels-open"),document.querySelector(".flypanels-content").style.marginRight="",P("onCloseRight")},u=function(){p()===!0&&q()===!1&&(document.querySelector(".flypanels-content").style.marginRight=e+"px"),document.querySelector("body").classList.add("flypanels-open"),document.querySelector("html").classList.add("flypanels-open"),P("onOpenLeft")},v=function(){p()===!0&&q()===!1&&(document.querySelector(".flypanels-content").style.marginRight=e+"px"),document.querySelector("body").classList.add("flypanels-open"),document.querySelector("html").classList.add("flypanels-open"),P("onOpenRight")},w=function(){var a=document.createElement("div");a.classList.add("overlay"),a.setAttribute("id","flypanels-overlay"),document.querySelector(".flypanels-content").appendChild(a),"click touchmove touchend touchleave touchcancel".split(" ").forEach(function(a){document.querySelector("#flypanels-overlay").addEventListener(a,function(a){r(),a.preventDefault()})}),P("onOpen")},x=function(){var a=document.querySelector("#flypanels-overlay");null!==a&&(a.classList.add("closing"),setTimeout(function(){a&&a.remove()},b.transitiontime)),P("onClose")},y=function(a){d.classList.add("openright"),document.querySelector(".flypanels-right").querySelector('[data-panel="'+a+'"]').style.display="block",v(),w()},z=function(){x(),d.classList.add("closing"),setTimeout(function(){d.classList.remove("openright"),d.classList.remove("closing");var a=document.querySelectorAll(".flypanels-right .panelcontent");R(a,function(a,b){a.style.display="none"}),t()},b.transitiontime)},A=function(a){d.classList.add("openleft"),document.querySelector(".flypanels-left").querySelector('[data-panel="'+a+'"]').style.display="block",u(),w()},B=function(){x(),d.classList.add("closing"),setTimeout(function(){d.classList.remove("closing"),d.classList.remove("openleft");var a=document.querySelectorAll(".flypanels-left .panelcontent");R(a,function(a,b){a.style.display="none"}),s()},b.transitiontime)},C=function(){h=window.innerHeight,n(),P("afterWindowResize")},D=function(){var a=document.querySelectorAll(".panelcontent");R(a,function(a,b){a.addEventListener("touchmove",function(b){a.scrollHeight<=parseInt(h,10)&&b.preventDefault()})}),document.querySelector(".flypanels-button-left").addEventListener("click",function(){var a=this.getAttribute("data-panel");F(document.querySelector(".flypanels-container"),"openleft")?B():F(document.querySelector(".flypanels-container"),"openright")?z():A(a)}),document.querySelector(".flypanels-button-right").addEventListener("click",function(){var a=this.getAttribute("data-panel");F(document.querySelector(".flypanels-container"),"openright")?z():F(document.querySelector(".flypanels-container"),"openleft")?B():y(a)}),i===!0&&(window.onresize=E),window.addEventListener("orientationchange",function(){n()}),P("OnAttachEvents")},E=function(){var a;clearTimeout(a),a=setTimeout(C,100),P("onWindowResize")},F=function(a,b){return"undefined"!=typeof a.classList&&a.classList.contains(b)?!0:!1},G=function(){return navigator.userAgent.toLowerCase().indexOf("android")>-1?!0:!1},H=function(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)?!0:!1},I=function(a){M("hide"),b.search.searchPanel.querySelector(".flypanels-searchresult").innerHTML="",b.search.searchPanel.querySelector(".resultinfo .query").innerHTML=a,b.search.searchPanel.querySelector(".resultinfo .num").innerHTML=0;var c=b.search.searchPanel.querySelector(".searchbox").getAttribute("data-searchurl");c=c+"&q="+a;var d=new XMLHttpRequest;d.open("GET",c,!0),d.onload=function(){if(d.status>=200&&d.status<400){var c=K(d.response);if(c!==!1){var e=c.Items.length;if(e>0){b.search.saveQueryCookie===!0&&O.set("searchQuery",a,null,"/");var f=J(c.Items);b.search.searchPanel.querySelector(".resultinfo .query").innerHTML=a,b.search.searchPanel.querySelector(".resultinfo .num").innerHTML=e,b.search.searchPanel.querySelector(".flypanels-searchresult").innerHTML=f,N("hide"),b.search.searchPanel.querySelector(".resultinfo").style.display="block",b.search.searchPanel.querySelector(".flypanels-searchresult").style.display="block",P("onSearchSuccess")}else P("onEmptySearchResult"),b.search.saveQueryCookie===!0&&O.remove("searchQuery","/"),N("hide"),M("show")}else P("onEmptySearchResult"),b.search.saveQueryCookie===!0&&O.remove("searchQuery","/"),N("hide"),M("show")}else M("show"),N("hide"),P("onSearchError")},d.onerror=function(){M("show")},d.send()},J=function(a){var b="<ul>";for(var c in a)b+="Page"===a[c].Type?'<li><a href="'+a[c].LinkUrl+'"><span class="link">'+a[c].Header+'</span>  <span class="type"><i class="fa page"></i></span></a>':'<li><a href="'+a[c].LinkUrl+'"><span class="link">'+a[c].Header+'</span>  <span class="type"><i class="fa doc"></i></span></a>';return b+="</ul>"},K=function(a){try{var b=JSON.parse(a);if(b&&"object"==typeof b&&null!==b)return b}catch(c){}return console.warn("Error parsing JSON file"),!1},L=function(){(G()||H())&&document.querySelector(".flypanels-searchresult").classList.add("touch"),b.search.searchPanel.querySelector(".searchbutton").addEventListener("click",function(a){a.preventDefault(),N("show"),I(b.search.searchPanel.querySelector(".searchbox input").value)}),b.search.searchPanel.querySelector(".searchbox input").addEventListener("keydown",function(a){13===a.which&&(N("show"),I(this.value),this.blur())}),O.has("searchQuery")===!0&&b.search.saveQueryCookie===!0&&I(O.get("searchQuery")),P("onInitSearch")},M=function(a){"hide"===a?b.search.searchPanel.querySelector(".errormsg").style.display="none":b.search.searchPanel.querySelector(".errormsg").style.display="block"},N=function(a){"hide"===a?b.search.searchPanel.querySelector(".loading").style.display="none":b.search.searchPanel.querySelector(".loading").style.display="block"},O={get:function(a){return a?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},set:function(a,b,c,d,e,f){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a))return!1;var g="";if(c)switch(c.constructor){case Number:g=c===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:g="; expires="+c;break;case Date:g="; expires="+c.toUTCString()}return document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+g+(e?"; domain="+e:"")+(d?"; path="+d:"")+(f?"; secure":""),!0},remove:function(a,b,c){return this.has(a)?(document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(c?"; domain="+c:"")+(b?"; path="+b:""),!0):!1},has:function(a){return a?new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie):!1},keys:function(){for(var a=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),b=a.length,c=0;b>c;c++)a[c]=decodeURIComponent(a[c]);return a}},P=function(a){void 0!==b[a]&&b[a].call(d)},Q=function(a,b){var c={};return R(a,function(b,d){c[d]=a[d]}),R(b,function(a,d){c[d]=b[d]}),c},R=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a);else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e,a)};return f.destroy=function(){b&&(document.documentElement.classList.remove(b.initClass),document.removeEventListener("click",eventHandler,!1),b=null,c=null,P("onDestroy"))},f.init=function(a){g&&(f.destroy(),m(),a.treeMenu=Q(j,a.treeMenu||{}),a.search=Q(k,a.search||{}),b=Q(l,a||{}),d=document.querySelector(b.container),n(),D(),b.search.init&&L(),b.treeMenu.init&&o(),d.classList.remove("preload"),P("onInit"))},f.closePanels=function(){r()},f});