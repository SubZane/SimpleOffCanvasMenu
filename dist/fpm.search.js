/*! flypanels - v3.1.1 - 2019-03-07
* https://www.andreasnorman.com/flyPanels/
* Copyright (c) 2019 ; Licensed  */

!function(e,r){"function"==typeof define&&define.amd?define([],r(e)):"object"==typeof exports?module.exports=r(e):e.fpm_search=r(e)}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";var a,r,s,c={},l=!!document.querySelector&&!!e.addEventListener,i={saveQueryCookie:!1,searchPanel:document.querySelector('.offcanvas [data-panel="search"]'),onInit:function(){},onDestroy:function(){},onEmptySearchResult:function(){},onSearchError:function(){},onSearchSuccess:function(){}},u=function(n){f("hide"),a.searchPanel.querySelector(".flypanels-searchresult").innerHTML="",a.searchPanel.querySelector(".resultinfo .query").innerHTML=n,a.searchPanel.querySelector(".resultinfo .num").innerHTML=0;var e=a.searchPanel.querySelector(".searchbox").getAttribute("data-searchurl");e=e+"&q="+n;var o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=function(){if(200<=o.status&&o.status<400){var e=d(o.response);if(!1!==e){var r=e.Items.length;if(0<r){!0===a.saveQueryCookie&&p.set("searchQuery",n,null,"/");var t=h(e.Items);a.searchPanel.querySelector(".resultinfo .query").innerHTML=n,a.searchPanel.querySelector(".resultinfo .num").innerHTML=r,a.searchPanel.querySelector(".flypanels-searchresult").innerHTML=t,s=document.querySelectorAll(".flypanels-button-right, .flypanels-right .searchbutton, #flypanels-searchfield, .flypanels-searchresult ul li a"),y("hide"),a.searchPanel.querySelector(".resultinfo").removeAttribute("hidden"),a.searchPanel.querySelector(".resultinfo").setAttribute("aria-hidden","false"),a.searchPanel.querySelector(".flypanels-searchresult").removeAttribute("hidden"),a.searchPanel.querySelector(".flypanels-searchresult").setAttribute("aria-hidden","false"),g("onSearchSuccess")}else g("onEmptySearchResult"),!0===a.saveQueryCookie&&p.remove("searchQuery","/"),y("hide"),f("show")}else g("onEmptySearchResult"),!0===a.saveQueryCookie&&p.remove("searchQuery","/"),y("hide"),f("show")}else f("show"),y("hide"),g("onSearchError")},o.onerror=function(){f("show")},o.send()},h=function(e){var r="<ul>";for(var t in e)"Page"===e[t].Type?r+='<li><a href="'+e[t].LinkUrl+'"><span class="type"><i class="fa page"></i></span><span class="link">'+e[t].Header+"</span></a>":r+='<li><a href="'+e[t].LinkUrl+'"><span class="type"><i class="fa doc"></i></span><span class="link">'+e[t].Header+"</span></a>";return r+="</ul>"},d=function(e){try{var r=JSON.parse(e);if(r&&"object"==typeof r&&null!==r)return r}catch(e){}return console.warn("Error parsing JSON file"),!1},f=function(e){"hide"===e?(a.searchPanel.querySelector(".errormsg").setAttribute("hidden",""),a.searchPanel.querySelector(".errormsg").setAttribute("aria-hidden","true")):(a.searchPanel.querySelector(".errormsg").removeAttribute("hidden"),a.searchPanel.querySelector(".errormsg").setAttribute("aria-hidden","false"))},y=function(e){"hide"===e?a.searchPanel.querySelector(".errormsg").setAttribute("hidden",""):a.searchPanel.querySelector(".errormsg").removeAttribute("hidden")},p={get:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},set:function(e,r,t,n,o,a){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var s="";if(t)switch(t.constructor){case Number:s=t===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+t;break;case String:s="; expires="+t;break;case Date:s="; expires="+t.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(r)+s+(o?"; domain="+o:"")+(n?"; path="+n:"")+(a?"; secure":""),!0},remove:function(e,r,t){return!!this.has(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(t?"; domain="+t:"")+(r?"; path="+r:""),!0)},has:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),r=e.length,t=0;t<r;t++)e[t]=decodeURIComponent(e[t]);return e}},m=function(e,r){return!(void 0===e.classList||!e.classList.contains(r))},g=function(e){void 0!==a[e]&&a[e].call(r)},v=function(e,r,t){if("[object Object]"===Object.prototype.toString.call(e))for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.call(t,e[n],n,e);else for(var o=0,a=e.length;o<a;o++)r.call(t,e[o],o,e)};return c.destroy=function(){a&&(document.documentElement.classList.remove(a.initClass),document.removeEventListener("click",eventHandler,!1),a=null,g("onDestroy"))},c.init=function(e){var t,n,o;l&&(c.destroy(),n=e||{},o={},v(t=i,function(e,r){o[r]=t[r]}),v(n,function(e,r){o[r]=n[r]}),a=o,r=document.querySelector(a.container),(-1<navigator.userAgent.toLowerCase().indexOf("android")||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))&&document.querySelector(".flypanels-searchresult").classList.add("touch"),a.searchPanel.querySelector(".searchbutton").addEventListener("click",function(e){e.preventDefault(),y("show"),u(a.searchPanel.querySelector(".searchbox input").value)}),a.searchPanel.querySelector(".searchbox input").addEventListener("keydown",function(e){13===e.which&&(y("show"),u(this.value))}),!0===p.has("searchQuery")&&!0===a.saveQueryCookie&&u(p.get("searchQuery")),s=s||document.querySelectorAll("#flypanels-searchfield, .flypanels-right .searchbutton, .flypanels-button-right"),document.addEventListener("keydown",function(e){m(document.querySelector("body"),"flypanels-open")&&m(document.querySelector(".flypanels-container"),"openright")&&9===e.keyCode&&(e.shiftKey?0===Array.prototype.indexOf.call(s,e.target)?s[s.length-1].focus():Array.prototype.indexOf.call(s,e.target)-1<0?s[0].focus():s[Array.prototype.indexOf.call(s,e.target)-1].focus():-1===Array.prototype.indexOf.call(s,e.target)?s[0].focus():Array.prototype.indexOf.call(s,e.target)+1===s.length?s[0].focus():s[Array.prototype.indexOf.call(s,e.target)+1].focus(),e.preventDefault())}),g("onInit"))},c});